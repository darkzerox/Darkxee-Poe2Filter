name: Discord Tag Notification

on:
  push:
    tags:
      - v*

jobs:
  notify-discord:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        
      - name: Debug event
        run: |
          echo "Event name: ${{ github.event_name }}"
          echo "Tag: ${{ github.ref_name }}"
          
      - name: Send Discord notification
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK_URL }}
          DISCORD_USERNAME: "DZX Filter POE2 Tag Bot"
          DISCORD_AVATAR: "https://raw.githubusercontent.com/${{ github.repository }}/master/dzx_filter/images/dzx-poe2-filter-logo.png"
        with:
          args: |
            {
              "embeds": [
                {
                  "title": "üè∑Ô∏è New tag pushed: ${{ github.ref_name }}",
                  "description": "A new version tag has been pushed to the repository.",
                  "url": "https://github.com/${{ github.repository }}/releases/tag/${{ github.ref_name }}",
                  "color": 5814783,
                  "fields": [
                    {
                      "name": "Tag",
                      "value": "${{ github.ref_name }}",
                      "inline": true
                    },
                    {
                      "name": "‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á",
                      "value": "${{ github.actor }}",
                      "inline": true
                    }
                  ],
                  "thumbnail": {
                    "url": "https://raw.githubusercontent.com/${{ github.repository }}/master/dzx_filter/images/dzx-poe2-filter-logo.png"
                  },
                  "footer": {
                    "text": "DZX Filter POE2 | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ ${{ github.event.head_commit.timestamp }}"
                  }
                }
              ]
            }
